{
  "rules": [
    {
      "type": "html",
      "file": "templates/base.html",
      "mustHaveElements": ["nav", "footer"],
      "mustHaveClasses": ["navbar", "container"], 
      "points": 10
    },
    {
      "type": "html",
      "file": "templates/index.html",
      "mustHaveElements": [ "a"],
      "mustHaveContent": ["Welcome to Flask Auth", "Get Started", "Login"],
      "points": 8
    },
    {
      "type": "html",
      "file": "templates/login.html",
      "mustHaveElements": ["form", "input", "button"],
      "mustHaveInputs": ["username", "password"],
      "mustHaveContent": ["Login", "Register here"],
      "points": 8
    },
    {
      "type": "html",
      "file": "templates/register.html",
      "mustHaveElements": ["form", "input", "button"],
      "mustHaveInputs": ["username", "email", "password", "confirm_password"],
      "mustHaveContent": ["Create Account", "Login here"],
      "points": 8
    },
    {
      "type": "html",
      "file": "templates/dashboard.html",
      "mustHaveElements": ["div", "h4", "h5"],
      "mustHaveClasses": ["card", "card-header", "card-body"],
      "mustHaveContent": ["Dashboard", "Welcome back"],
      "points": 8
    },
    {
      "type": "html",
      "file": "templates/profile.html",
      "mustHaveElements": ["div", "h4", "h5"],
      "mustHaveClasses": ["card", "card-header", "card-body"],
      "mustHaveContent": ["User Profile", "Account Details"],
      "points": 8
    },
    {
      "type": "requirements",
      "file": "requirements.txt",
      "mustHavePackages": ["Flask", "Flask-SQLAlchemy", "Werkzeug"],
      "points": 5
    },
    {
      "type": "database",
      "file": "instance/users.db",
      "mustExist": true,
      "points": 5
    },
      {
        "type": "security",
        "file": "app.py",
        "mustHaveSecurity": ["password hashing", "session management", "user validation"],
        "points": 10
      },
      {
        "type": "runtime",
        "file": "app.py",
        "mustHaveRoutes": ["/", "/register", "/login", "/logout", "/profile"],
        "points": 25
      },
      {
        "type": "boilerplate",
        "file": "templates/register.html",
        "expected_structure": {
          "div": {
            "div": {
              "form": {
                "div": {},
                "div": {},
                "button": {}
              }
            }
          }
        },
        "required_classes": ["form-container", "submit-btn", "form-group"],
        "required_functions": ["validateForm", "submitHandler"],
        "points": 15
      },
      {
        "type": "boilerplate",
        "file": "templates/login.html",
        "expected_structure": {
          "div": {
            "div": {
              "form": {
                "div": {},
                "div": {},
                "button": {}
              }
            }
          }
        },
        "required_classes": ["login-container", "form-group", "btn-primary"],
        "required_functions": ["validateLogin"],
        "points": 10
      },
      {
        "type": "boilerplate",
        "file": "templates/index.html",
        "expected_structure": {
          "div": {
            "div": {
              "h1": {},
              "div": {
                "p": {}
              }
            }
          }
        },
        "required_classes": ["main-container", "content-section", "welcome-text"],
        "points": 8
      },
      {
        "type": "boilerplate",
        "file": "templates/dashboard.html",
        "expected_structure": {
          "div": {
            "div": {
              "h2": {},
              "div": {
                "table": {
                  "thead": {},
                  "tbody": {}
                }
              }
            }
          }
        },
        "required_classes": ["dashboard-container", "data-table", "table-header"],
        "required_functions": ["loadData", "refreshTable"],
        "points": 20
      },
      {
        "type": "boilerplate",
        "file": "app.py",
        "expected_structure": {
          "imports": [
            "flask",
            "flask_sqlalchemy",
            "werkzeug.security",
            "datetime",
            "os"
          ],
          "classes": {
            "User": {
              "attributes": ["id", "username", "email", "password_hash", "created_at"],
              "methods": ["set_password", "check_password", "__repr__"]
            }
          },
          "routes": {
            "/": {
              "methods": ["GET"],
              "renders": ["index.html", "dashboard.html"]
            },
            "/register": {
              "methods": ["GET", "POST"],
              "renders": ["register.html"]
            },
            "/login": {
              "methods": ["GET", "POST"],
              "renders": ["login.html"]
            },
            "/logout": {
              "methods": ["GET"],
              "redirects_to": ["index"]
            },
            "/profile": {
              "methods": ["GET"],
              "renders": ["profile.html"]
            }
          }
        },
        "required_functions": [
          "set_password",
          "check_password",
          "index",
          "register",
          "login",
          "logout",
          "profile"
        ],
        "required_security": {
          "secret_key": true,
          "password_hashing": true,
          "session_management": true
        },
        "required_files": [
          "templates/index.html",
          "templates/register.html",
          "templates/login.html",
          "templates/dashboard.html",
          "templates/profile.html",
          "instance/users.db"
        ],
        "required_flask_components": [
          "Flask",
          "SQLAlchemy",
          "render_template",
          "redirect",
          "url_for",
          "flash",
          "session"
        ],
        "validation_rules": {
          "must_define_db": true,
          "must_call_db_create_all": true,
          "must_use_flask_app_context": true,
          "must_run_app": true
        },
        "points": 30
      }      
  ],
  "ui_tests": [
    {
      "route": "/register",
      "page_title": "Register",
      "fileds":"",
      "description": "Test user registration functionality",
      "test_cases": [
        {
          "name": "Valid Registration",
          "description": "Test successful user registration with valid data",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "register_form_username",
              "type": "short_text",
              "input_value": "test_user_123",
              "required": true
            },
            {
              "identifier_type": "class", 
              "identifier_name": "register_form_email",
              "type": "email",
              "input_value": "test@example.com",
              "required": true
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_password",
              "type": "password",
              "input_value": "StrongPass123!",
              "required": true
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_confirm_password",
              "type": "password", 
              "input_value": "StrongPass123!",
              "required": true
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_submit_button",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "redirect",
            "url_contains": "/login",
            "success_message": "Registration successful"
          },
          "timeout": 10,
          "points": 15
        },
        {
          "name": "Weak Password Rejection",
          "description": "Test that weak passwords are rejected",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "register_form_username",
              "type": "short_text",
              "input_value": "weak_user"
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_password",
              "type": "password",
              "input_value": "12345"
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_submit_button",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "error",
            "error_contains": "password too short",
            "stay_on_page": true
          },
          "timeout": 5,
          "points": 10
        },
        {
          "name": "Duplicate Username Rejection",
          "description": "Test that duplicate usernames are rejected",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "register_form_username",
              "type": "short_text",
              "input_value": "existing_user"
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_password",
              "type": "password",
              "input_value": "ValidPass123!"
            },
            {
              "identifier_type": "class",
              "identifier_name": "register_form_submit_button",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "error",
            "error_contains": "username already exists",
            "stay_on_page": true
          },
          "timeout": 5,
          "points": 10
        }
      ]
    },
    {
      "route": "/login",
      "page_title": "Login",
      "description": "Test user authentication functionality",
      "test_cases": [
        {
          "name": "Valid Login",
          "description": "Test successful login with valid credentials",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "login_username",
              "type": "short_text",
              "input_value": "test_user_123"
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_password",
              "type": "password",
              "input_value": "StrongPass123!"
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_submit",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "redirect",
            "url_contains": "/dashboard",
            "success_message": "Login successful"
          },
          "timeout": 10,
          "points": 15
        },
        {
          "name": "Invalid Credentials",
          "description": "Test login failure with invalid credentials",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "login_username",
              "type": "short_text",
              "input_value": "wrong_user"
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_password",
              "type": "password",
              "input_value": "wrong_password"
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_submit",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "error",
            "error_contains": "invalid credentials",
            "stay_on_page": true
          },
          "timeout": 5,
          "points": 10
        },
        {
          "name": "Empty Fields Validation",
          "description": "Test that empty fields are handled properly",
          "identifiers": [
            {
              "identifier_type": "class",
              "identifier_name": "login_username",
              "type": "short_text",
              "input_value": ""
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_password",
              "type": "password",
              "input_value": ""
            },
            {
              "identifier_type": "class",
              "identifier_name": "login_submit",
              "type": "button",
              "action": "click"
            }
          ],
          "expected_result": {
            "type": "error",
            "error_contains": "required",
            "stay_on_page": true
          },
          "timeout": 5,
          "points": 5
        }
      ]
    },
    {
      "route": "/dashboard",
      "page_title": "Dashboard",
      "description": "Test dashboard functionality and user session",
      "test_cases": [
        {
          "name": "Dashboard Load Test",
          "description": "Test that dashboard loads with required elements",
          "actions": [
            {
              "identifier_type": "text",
              "identifier_name": "Welcome",
              "check_type": "exists",
              "description": "Welcome message should be present"
            },
            {
              "identifier_type": "class",
              "identifier_name": "logout_button",
              "check_type": "exists",
              "description": "Logout button should be present"
            },
            {
              "identifier_type": "class",
              "identifier_name": "user_profile",
              "check_type": "exists",
              "description": "User profile section should be present"
            }
          ],
          "expected_result": {
            "type": "success",
            "all_elements_present": true
          },
          "timeout": 5,
          "points": 10
        },
        {
          "name": "Logout Functionality",
          "description": "Test that logout works correctly",
          "actions": [
            {
              "identifier_type": "class",
              "identifier_name": "logout_button",
              "check_type": "click",
              "description": "Click logout button"
            }
          ],
          "expected_result": {
            "type": "redirect",
            "url_contains": "/login",
            "success_message": "Logged out successfully"
          },
          "timeout": 5,
          "points": 10
        }
      ]
    },
    {
      "route": "/profile",
      "page_title": "Profile",
      "description": "Test user profile management",
      "test_cases": [
        {
          "name": "Profile Page Load",
          "description": "Test that profile page loads correctly",
          "actions": [
            {
              "identifier_type": "class",
              "identifier_name": "profile_form",
              "check_type": "exists",
              "description": "Profile form should be present"
            },
            {
              "identifier_type": "class",
              "identifier_name": "update_button",
              "check_type": "exists",
              "description": "Update button should be present"
            }
          ],
          "expected_result": {
            "type": "success",
            "all_elements_present": true
          },
          "timeout": 5,
          "points": 5
        }
      ]
    }
  ]
}
